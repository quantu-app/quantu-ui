import{w as J,d as x}from"./index-35f43e1d.js";import{a1 as m}from"./index-6adb3884.js";const b={};function F(e){return e}function W(e){return e}function T(e,w,s={}){const p=typeof window<"u"&&typeof window.localStorage<"u",O=s.toJSON||W,y=s.fromJSON||F;function _(f,i){return p&&window.localStorage.setItem(f,JSON.stringify(O(i))),i}if(!b[e]){let n=function(t){_(e,t),o(t)};const f=J(w,t=>{const l=p?window.localStorage.getItem(e):null;if(l&&t(y(JSON.parse(l))),p){let c=function(a){a.key===e&&t(a.newValue?y(JSON.parse(a.newValue)):null)};return window.addEventListener("storage",c),()=>{window.removeEventListener("storage",c)}}}),{subscribe:i,set:o}=f;b[e]={set:n,update(t){n(t(m(f)))},subscribe:i}}return b[e]}const C=T("jwt",null),U=x(C,e=>e);function V(){var e;return{Authorization:((e=m(U))==null?void 0:e.token)||""}}function D(e){C.set(e)}function z(e){return{...e,created_at:new Date(e.created_at),updated_at:new Date(e.updated_at)}}function Q(e){return{...e,exp:new Date(e.exp)}}async function R(e,w){const s=await fetch(`${{}.VITE_QUANTU_API_URL}/api/auth/login`,{method:"POST",body:JSON.stringify({email:e,password:w}),headers:{"Content-Type":"application/json"}});if(s.ok){const p=Q(await s.json());return D(p),j()}else throw s}async function j(){const e=await fetch(`${{}.VITE_QUANTU_API_URL}/api/auth/me`,{headers:{...V(),"Content-Type":"application/json"}});if(e.ok)return z(await e.json());throw e}var S={},$={get exports(){return S},set exports(e){S=e}};(function(e){var w=Object.prototype.hasOwnProperty,s="~";function p(){}Object.create&&(p.prototype=Object.create(null),new p().__proto__||(s=!1));function O(i,o,n){this.fn=i,this.context=o,this.once=n||!1}function y(i,o,n,t,l){if(typeof n!="function")throw new TypeError("The listener must be a function");var c=new O(n,t||i,l),a=s?s+o:o;return i._events[a]?i._events[a].fn?i._events[a]=[i._events[a],c]:i._events[a].push(c):(i._events[a]=c,i._eventsCount++),i}function _(i,o){--i._eventsCount===0?i._events=new p:delete i._events[o]}function f(){this._events=new p,this._eventsCount=0}f.prototype.eventNames=function(){var o=[],n,t;if(this._eventsCount===0)return o;for(t in n=this._events)w.call(n,t)&&o.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(n)):o},f.prototype.listeners=function(o){var n=s?s+o:o,t=this._events[n];if(!t)return[];if(t.fn)return[t.fn];for(var l=0,c=t.length,a=new Array(c);l<c;l++)a[l]=t[l].fn;return a},f.prototype.listenerCount=function(o){var n=s?s+o:o,t=this._events[n];return t?t.fn?1:t.length:0},f.prototype.emit=function(o,n,t,l,c,a){var h=s?s+o:o;if(!this._events[h])return!1;var r=this._events[h],v=arguments.length,d,u;if(r.fn){switch(r.once&&this.removeListener(o,r.fn,void 0,!0),v){case 1:return r.fn.call(r.context),!0;case 2:return r.fn.call(r.context,n),!0;case 3:return r.fn.call(r.context,n,t),!0;case 4:return r.fn.call(r.context,n,t,l),!0;case 5:return r.fn.call(r.context,n,t,l,c),!0;case 6:return r.fn.call(r.context,n,t,l,c,a),!0}for(u=1,d=new Array(v-1);u<v;u++)d[u-1]=arguments[u];r.fn.apply(r.context,d)}else{var P=r.length,g;for(u=0;u<P;u++)switch(r[u].once&&this.removeListener(o,r[u].fn,void 0,!0),v){case 1:r[u].fn.call(r[u].context);break;case 2:r[u].fn.call(r[u].context,n);break;case 3:r[u].fn.call(r[u].context,n,t);break;case 4:r[u].fn.call(r[u].context,n,t,l);break;default:if(!d)for(g=1,d=new Array(v-1);g<v;g++)d[g-1]=arguments[g];r[u].fn.apply(r[u].context,d)}}return!0},f.prototype.on=function(o,n,t){return y(this,o,n,t,!1)},f.prototype.once=function(o,n,t){return y(this,o,n,t,!0)},f.prototype.removeListener=function(o,n,t,l){var c=s?s+o:o;if(!this._events[c])return this;if(!n)return _(this,c),this;var a=this._events[c];if(a.fn)a.fn===n&&(!l||a.once)&&(!t||a.context===t)&&_(this,c);else{for(var h=0,r=[],v=a.length;h<v;h++)(a[h].fn!==n||l&&!a[h].once||t&&a[h].context!==t)&&r.push(a[h]);r.length?this._events[c]=r.length===1?r[0]:r:_(this,c)}return this},f.prototype.removeAllListeners=function(o){var n;return o?(n=s?s+o:o,this._events[n]&&_(this,n)):(this._events=new p,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=s,f.EventEmitter=f,e.exports=f})($);const A=S,I=new A,E=J(typeof navigator=="object"?navigator.onLine:!1),G=x(E,e=>e);function H(){return m(G)}function q(){E.set(!0),I.emit("online")}function B(){E.set(!1),I.emit("offline")}typeof window=="object"&&(window.addEventListener("online",q),window.addEventListener("offline",B));const L=T("user",null),K=x(L,e=>e);async function Z(e,w){const s=await R(e,w);return L.set(s),s}async function ee(){return new Promise(e=>k.once("user",e))}const k=new A;let N=!1;async function te(){let e=m(K);return H()&&(N||(N=!0,e=await M())),e&&k.emit("user",e),e}async function M(){var w;if((w=m(U))==null?void 0:w.token){const s=await j();return L.set(s),s}else return null}export{A as E,H as a,V as g,te as i,Z as s,ee as w};
