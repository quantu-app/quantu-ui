import{d as Je,w as Ye}from"./index-9253242f.js";import{E as Pe,o as Ze,w as Ce,a as Ne,q as V,g as et}from"./user-ed7e6b8d.js";import{A as Ve,a1 as Oe,S as j,i as F,s as re,M as I,w as M,x as q,y as T,N as ae,O as le,f as m,t as b,z as P,P as L,Q as ce,R as ue,m as w,h as f,n as h,b as C,B as O,F as x,k as E,a as J,l as D,c as Y,T as S,K as y,U as ye,a6 as Ee,g as K,d as G,D as tt,G as je,H as Fe,I as Ue,J as Re,e as De}from"./index-5ae55930.js";import{I as de}from"./IconBase-8e12acc1.js";function Ie(){return Math.random().toString(36).substring(2)}function We(t){return t.trim().replace(/\s+/g,"-").replace(/[^a-z0-9-_]/gi,"").toLowerCase()}function Wt(t){Ve().then(()=>t.focus())}const nt=(t,e)=>e.some(o=>t instanceof o);let ke,Be;function ot(){return ke||(ke=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function st(){return Be||(Be=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xe=new WeakMap,oe=new WeakMap,Ke=new WeakMap,Z=new WeakMap,fe=new WeakMap;function it(t){const e=new Promise((o,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{o(B(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)});return e.then(o=>{o instanceof IDBCursor&&xe.set(o,t)}).catch(()=>{}),fe.set(e,t),e}function rt(t){if(oe.has(t))return;const e=new Promise((o,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{o(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)});oe.set(t,e)}let se={get(t,e,o){if(t instanceof IDBTransaction){if(e==="done")return oe.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ke.get(t);if(e==="store")return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return B(t[e])},set(t,e,o){return t[e]=o,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function at(t){se=t(se)}function lt(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...o){const n=t.call(ee(this),e,...o);return Ke.set(n,e.sort?e.sort():[e]),B(n)}:st().includes(t)?function(...e){return t.apply(ee(this),e),B(xe.get(this))}:function(...e){return B(t.apply(ee(this),e))}}function ct(t){return typeof t=="function"?lt(t):(t instanceof IDBTransaction&&rt(t),nt(t,ot())?new Proxy(t,se):t)}function B(t){if(t instanceof IDBRequest)return it(t);if(Z.has(t))return Z.get(t);const e=ct(t);return e!==t&&(Z.set(t,e),fe.set(e,t)),e}const ee=t=>fe.get(t);function ut(t,e,{blocked:o,upgrade:n,blocking:i,terminated:s}={}){const r=indexedDB.open(t,e),c=B(r);return n&&r.addEventListener("upgradeneeded",a=>{n(B(r.result),a.oldVersion,a.newVersion,B(r.transaction),a)}),o&&r.addEventListener("blocked",a=>o(a.oldVersion,a.newVersion,a)),c.then(a=>{s&&a.addEventListener("close",()=>s()),i&&a.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}const dt=["get","getKey","getAll","getAllKeys","count"],ft=["put","add","delete","clear"],te=new Map;function Qe(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(te.get(e))return te.get(e);const o=e.replace(/FromIndex$/,""),n=e!==o,i=ft.includes(o);if(!(o in(n?IDBIndex:IDBObjectStore).prototype)||!(i||dt.includes(o)))return;const s=async function(r,...c){const a=this.transaction(r,i?"readwrite":"readonly");let l=a.store;return n&&(l=l.index(c.shift())),(await Promise.all([l[o](...c),i&&a.done]))[0]};return te.set(e,s),s}at(t=>({...t,get:(e,o,n)=>Qe(e,o)||t.get(e,o,n),has:(e,o)=>!!Qe(e,o)||t.has(e,o)}));const _t="quantu",mt=1,pt={upgrade(t,e,o){o===1&&(t.createObjectStore("quizzes",{keyPath:"local_id",autoIncrement:!0}).createIndex("user_id","user_id"),t.createObjectStore("questions",{keyPath:"local_id",autoIncrement:!0}).createIndex("user_id","user_id"))}};function N(){return ht(_t,mt,pt)}let W,ne=!1;const Ae=new Pe;function ht(t,e,o={}){return W?Promise.resolve(W):ne?new Promise(n=>Ae.once("db",n)):(ne=!0,ut(t,e,o).then(n=>(n.addEventListener("close",()=>{W=void 0}),W=n,Ae.emit("db",n),n)).finally(()=>{ne=!1}))}async function bt(t){return await(await N()).getAllFromIndex("quizzes","user_id",t)}async function xt(t){return await(await N()).get("quizzes",t)}async function Ge(t,e){const o=await N(),n={..._e(t),...e,uri:We(e.name)},i=await o.put("quizzes",n);return{...n,local_id:i}}async function zt(t,e,o){const n=await N(),i=await n.get("quizzes",e)||_e(t),s={...i,...o,user_id:t,local_id:e,uri:o.name?We(o.name):i.uri,updated_at:new Date};return await n.put("quizzes",s,e),s}async function wt(t,e,o){const n=await N(),s={...await n.get("quizzes",e)||_e(t),...o,user_id:t,local_id:e};return await n.put("quizzes",s),s}async function Se(t){await(await N()).delete("quizzes",t)}function _e(t){return{id:0,local_deleted:0,user_id:t,name:"",uri:"",created_at:new Date,updated_at:new Date}}const $=Ye({}),Kt=Je($,t=>Object.values(t));async function Gt(t){var i;const e=(i=et())==null?void 0:i.id;let o={};Ne()&&(o=await V.postApiQuizzes({postApiQuizzes:t}));const n=await Ge(e,{...t,...o});return $.update(s=>({...s,[n.local_id]:n})),n}function Ht(){return ie?new Promise(t=>He.once("quizzes",t)):Promise.resolve(Oe($))}const He=new Pe;let ie=!1;async function Xe(t){ie=!0;try{const e=await bt(t),o={},n={},i=[];for(const s of e)s.id===0?i.push(s):n[s.id]=s,s.local_deleted===0&&(o[s.local_id]=s);if($.update(s=>({...s,...o})),Ne()){const s=await V.getApiQuizzes(),r={},c=new Set,a=[];for(const l of s){const u=n[l.id];u?u.updated_at>l.updated_at?u.local_deleted===1?a.push(V.deleteApiQuizzesId({id:l.id}).then(()=>Se(u.local_id)).then(()=>{c.add(u.local_id)})):a.push(V.patchApiQuizzesId({id:l.id,patchApiQuizzesId:{...l,...u}}).then(_=>{r[u.id]={...u,..._}})):u.updated_at<l.updated_at?a.push(zt(t,u.local_id,{...u,...l}).then(_=>{r[_.local_id]=_})):r[u.local_id]={...u,...l}:a.push(Ge(t,l).then(_=>{r[_.local_id]=_}))}for(const l of i)a.push(V.postApiQuizzes({postApiQuizzes:l}).then(u=>wt(t,l.local_id,u)).then(u=>{r[u.local_id]=u}));await Promise.all(a),await Promise.all(Object.values(n).map(async l=>{r[l.local_id]||(c.add(l.local_id),await Se(l.local_id))})),$.update(l=>{l={...l,...r};for(const u of c)delete l[u];return l})}}finally{ie=!1,He.emit("quizzes",Oe($))}}Ze.on("online",async()=>{const t=await Ce();Xe(t.id)});Ce().then(t=>Xe(t.id));function vt(t,e="body"){let o;async function n(s){if(e=s,typeof e=="string"){if(o=document.querySelector(e),o===null&&(await Ve(),o=document.querySelector(e)),o===null)throw new Error(`No element found matching css selector: "${e}"`)}else if(e instanceof HTMLElement)o=e;else throw new TypeError(`Unknown portal target type: ${e===null?"null":typeof e}. Allowed types: string (CSS selector) or HTMLElement.`);o.appendChild(t),t.hidden=!1}function i(){t.parentNode&&t.parentNode.removeChild(t)}return n(e),{update:n,destroy:i}}function gt(t){let e;return{c(){e=ce("path"),this.h()},l(o){e=ue(o,"path",{d:!0}),w(e).forEach(f),this.h()},h(){h(e,"d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z")},m(o,n){C(o,e,n)},p:O,d(o){o&&f(e)}}}function yt(t){let e,o;const n=[{viewBox:"0 0 24 24"},t[0]];let i={$$slots:{default:[gt]},$$scope:{ctx:t}};for(let s=0;s<n.length;s+=1)i=I(i,n[s]);return e=new de({props:i}),{c(){M(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){T(e,s,r),o=!0},p(s,[r]){const c=r&1?ae(n,[n[0],le(s[0])]):{};r&2&&(c.$$scope={dirty:r,ctx:s}),e.$set(c)},i(s){o||(m(e.$$.fragment,s),o=!0)},o(s){b(e.$$.fragment,s),o=!1},d(s){P(e,s)}}}function Et(t,e,o){return t.$$set=n=>{o(0,e=I(I({},e),L(n)))},e=L(e),[e]}class Dt extends j{constructor(e){super(),F(this,e,Et,yt,re,{})}}var It=function(t,e){e===void 0&&(e={enabled:!0});var o=$e(e),n=o.enabled,i=o.eventType,s=o.nodeForEvent,r=o.options,c=o.capture,a=function(l){t&&!t.contains(l.target)&&!l.defaultPrevented&&t.dispatchEvent(new CustomEvent("clickoutside",{detail:l}))};return e.enabled!==!1&&s.addEventListener(i,a,r),{update:function(l){var u;s.removeEventListener(i,a,c),u=$e(l),n=u.enabled,i=u.eventType,s=u.nodeForEvent,r=u.options,c=u.capture,n&&s.addEventListener(i,a,r)},destroy:function(){s.removeEventListener(i,a,c)}}};function $e(t){var e,o,n,i,s;return{enabled:(e=t.enabled)!==null&&e!==void 0?e:!0,nodeForEvent:(n=(o=t.limit)===null||o===void 0?void 0:o.parent)!==null&&n!==void 0?n:document,eventType:(i=t.event)!==null&&i!==void 0?i:"click",options:t.options,capture:typeof t.options=="object"?(s=t.options)===null||s===void 0?void 0:s.capture:t.options}}const kt=t=>({}),Le=t=>({});function Me(t){let e;const o=t[8].title,n=je(o,t,t[7],Le);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s&128)&&Fe(n,o,i,i[7],e?Re(o,i[7],s,kt):Ue(i[7]),Le)},i(i){e||(m(n,i),e=!0)},o(i){b(n,i),e=!1},d(i){n&&n.d(i)}}}function qe(t){let e;const o=t[8].default,n=je(o,t,t[7],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s&128)&&Fe(n,o,i,i[7],e?Re(o,i[7],s,null):Ue(i[7]),null)},i(i){e||(m(n,i),e=!0)},o(i){b(n,i),e=!1},d(i){n&&n.d(i)}}}function Bt(t){let e,o,n,i,s,r,c,a,l=t[2],u,_,k,p,H,Q,me=t[2],A,X,pe,v=Me(t);p=new Dt({});let g=qe(t);return{c(){e=E("div"),o=E("div"),n=J(),i=E("div"),s=E("div"),r=E("div"),c=E("div"),a=E("div"),v.c(),u=J(),_=E("button"),k=E("div"),M(p.$$.fragment),H=J(),Q=E("div"),g.c(),this.h()},l(d){e=D(d,"DIV",{class:!0,role:!0,"aria-modal":!0});var z=w(e);o=D(z,"DIV",{class:!0}),w(o).forEach(f),n=Y(z),i=D(z,"DIV",{class:!0});var he=w(i);s=D(he,"DIV",{class:!0});var be=w(s);r=D(be,"DIV",{class:!0});var U=w(r);c=D(U,"DIV",{class:!0});var R=w(c);a=D(R,"DIV",{class:!0});var ze=w(a);v.l(ze),ze.forEach(f),u=Y(R),_=D(R,"BUTTON",{class:!0});var we=w(_);k=D(we,"DIV",{class:!0});var ve=w(k);q(p.$$.fragment,ve),ve.forEach(f),we.forEach(f),R.forEach(f),H=Y(U),Q=D(U,"DIV",{class:!0});var ge=w(Q);g.l(ge),ge.forEach(f),U.forEach(f),be.forEach(f),he.forEach(f),z.forEach(f),this.h()},h(){h(o,"class","fixed inset-0 bg-gray-500 bg-opacity-25"),S(o,"hidden",!t[0]),h(a,"class","flex-grow"),h(k,"class","w-6 h-6"),h(_,"class","bg-transparent border-0 text-black outline-none focus:outline-none"),h(c,"class","flex flex-row flex-shrink items-start justify-between px-4 pt-4"),h(Q,"class","relative p-4 flex-col flex-grow"),h(r,"class","relative bg-white shadow-xl sm:my-8 sm:w-full sm:max-w-lg"),S(r,"m-auto",t[1]),h(s,"class","flex min-h-full items-end justify-center p-4 sm:items-center sm:p-0"),h(i,"class","fixed z-[10000] inset-0 overflow-y-auto"),S(i,"hidden",!t[0]),h(e,"class","relative z-[10000]"),h(e,"role","dialog"),h(e,"aria-modal","true")},m(d,z){C(d,e,z),y(e,o),y(e,n),y(e,i),y(i,s),y(s,r),y(r,c),y(c,a),v.m(a,null),y(c,u),y(c,_),y(_,k),T(p,k,null),y(r,H),y(r,Q),g.m(Q,null),A=!0,X||(pe=[ye(_,"click",t[3]),Ee(It.call(null,r)),ye(r,"clickoutside",t[4]),Ee(vt.call(null,e))],X=!0)},p(d,[z]){(!A||z&1)&&S(o,"hidden",!d[0]),z&4&&x(l,l=d[2])?(K(),b(v,1,1,O),G(),v=Me(d),v.c(),m(v,1),v.m(a,null)):v.p(d,z),z&4&&x(me,me=d[2])?(K(),b(g,1,1,O),G(),g=qe(d),g.c(),m(g,1),g.m(Q,null)):g.p(d,z),(!A||z&2)&&S(r,"m-auto",d[1]),(!A||z&1)&&S(i,"hidden",!d[0])},i(d){A||(m(v),m(p.$$.fragment,d),m(g),A=!0)},o(d){b(v),b(p.$$.fragment,d),b(g),A=!1},d(d){d&&f(e),v.d(d),P(p),g.d(d),X=!1,tt(pe)}}}function Qt(t,e,o){let{$$slots:n={},$$scope:i}=e,{onClose:s=()=>{}}=e,{small:r=!1}=e,{open:c=!1}=e,a=Ie(),l,u;function _(){o(0,c=!1),s()}function k(){u<=Date.now()-100&&(o(0,c=!1),s())}return t.$$set=p=>{"onClose"in p&&o(5,s=p.onClose),"small"in p&&o(1,r=p.small),"open"in p&&o(0,c=p.open),"$$scope"in p&&o(7,i=p.$$scope)},t.$$.update=()=>{t.$$.dirty&65&&l!==c&&(o(2,a=Ie()),o(6,l=c),u=Date.now())},[c,r,a,_,k,s,l,i,n]}class Xt extends j{constructor(e){super(),F(this,e,Qt,Bt,x,{onClose:5,small:1,open:0})}}function At(t){let e;return{c(){e=ce("path"),this.h()},l(o){e=ue(o,"path",{d:!0}),w(e).forEach(f),this.h()},h(){h(e,"d","M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z")},m(o,n){C(o,e,n)},p:O,d(o){o&&f(e)}}}function St(t){let e,o;const n=[{viewBox:"0 0 24 24"},t[0]];let i={$$slots:{default:[At]},$$scope:{ctx:t}};for(let s=0;s<n.length;s+=1)i=I(i,n[s]);return e=new de({props:i}),{c(){M(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){T(e,s,r),o=!0},p(s,[r]){const c=r&1?ae(n,[n[0],le(s[0])]):{};r&2&&(c.$$scope={dirty:r,ctx:s}),e.$set(c)},i(s){o||(m(e.$$.fragment,s),o=!0)},o(s){b(e.$$.fragment,s),o=!1},d(s){P(e,s)}}}function $t(t,e,o){return t.$$set=n=>{o(0,e=I(I({},e),L(n)))},e=L(e),[e]}class Lt extends j{constructor(e){super(),F(this,e,$t,St,re,{})}}function Mt(t){let e;return{c(){e=ce("path"),this.h()},l(o){e=ue(o,"path",{d:!0}),w(e).forEach(f),this.h()},h(){h(e,"d","M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z")},m(o,n){C(o,e,n)},p:O,d(o){o&&f(e)}}}function qt(t){let e,o;const n=[{viewBox:"0 0 24 24"},t[0]];let i={$$slots:{default:[Mt]},$$scope:{ctx:t}};for(let s=0;s<n.length;s+=1)i=I(i,n[s]);return e=new de({props:i}),{c(){M(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){T(e,s,r),o=!0},p(s,[r]){const c=r&1?ae(n,[n[0],le(s[0])]):{};r&2&&(c.$$scope={dirty:r,ctx:s}),e.$set(c)},i(s){o||(m(e.$$.fragment,s),o=!0)},o(s){b(e.$$.fragment,s),o=!1},d(s){P(e,s)}}}function Tt(t,e,o){return t.$$set=n=>{o(0,e=I(I({},e),L(n)))},e=L(e),[e]}class Pt extends j{constructor(e){super(),F(this,e,Tt,qt,re,{})}}function Te(t){let e,o,n,i;const s=[Nt,Ct],r=[];function c(a,l){return a[1]?0:1}return o=c(t),n=r[o]=s[o](t),{c(){e=E("span"),n.c(),this.h()},l(a){e=D(a,"SPAN",{class:!0});var l=w(e);n.l(l),l.forEach(f),this.h()},h(){h(e,"class","inline-block w-4 h-4")},m(a,l){C(a,e,l),r[o].m(e,null),i=!0},p(a,l){let u=o;o=c(a),o!==u&&(K(),b(r[u],1,1,()=>{r[u]=null}),G(),n=r[o],n||(n=r[o]=s[o](a),n.c()),m(n,1),n.m(e,null))},i(a){i||(m(n),i=!0)},o(a){b(n),i=!1},d(a){a&&f(e),r[o].d()}}}function Ct(t){let e,o;return e=new Lt({}),{c(){M(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,i){T(e,n,i),o=!0},i(n){o||(m(e.$$.fragment,n),o=!0)},o(n){b(e.$$.fragment,n),o=!1},d(n){P(e,n)}}}function Nt(t){let e,o;return e=new Pt({}),{c(){M(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,i){T(e,n,i),o=!0},i(n){o||(m(e.$$.fragment,n),o=!0)},o(n){b(e.$$.fragment,n),o=!1},d(n){P(e,n)}}}function Vt(t){let e,o,n=t[0]&&Te(t);return{c(){n&&n.c(),e=De()},l(i){n&&n.l(i),e=De()},m(i,s){n&&n.m(i,s),C(i,e,s),o=!0},p(i,[s]){i[0]?n?(n.p(i,s),s&1&&m(n,1)):(n=Te(i),n.c(),m(n,1),n.m(e.parentNode,e)):n&&(K(),b(n,1,1,()=>{n=null}),G())},i(i){o||(m(n),o=!0)},o(i){b(n),o=!1},d(i){n&&n.d(i),i&&f(e)}}}function Ot(t,e,o){let{sort:n=!1}=e,{asc:i=!0}=e;return t.$$set=s=>{"sort"in s&&o(0,n=s.sort),"asc"in s&&o(1,i=s.asc)},[n,i]}class Jt extends j{constructor(e){super(),F(this,e,Ot,Vt,x,{sort:0,asc:1})}}export{Xt as M,Jt as S,Wt as a,We as b,Gt as c,Ht as d,N as g,xt as i,Kt as q};
